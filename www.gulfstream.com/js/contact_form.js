var supportEmail,ip,lang=document.querySelector("html").getAttribute("lang"),provinces=[],states=[],supportEmails=[],countries=[],stateData=window._DATA.contacts.states,supportEmailData=window._DATA.contacts.supportEmails,countryData=window._DATA.contacts.countries,terrTranslations=window._DATA.contacts.salesTerritories,globalLangData=window._DATA.lang[lang].contacts;for(var key in stateData)"none"!=key.toLowerCase()&&(2<key.length?provinces.push({id:key,name:stateData[key].state[lang]}):states.push({id:key,name:stateData[key].state[lang]}));for(var key in countryData)countries.push({id:key,name:countryData[key].territory[lang]});for(var i=0;i<supportEmailData.length;i++)supportEmails.push({id:supportEmailData[i].option[lang]?supportEmailData[i].option[lang]:"",email:supportEmailData[i].email});var vm=new Vue({el:"#contact__form",data:{api_key:"dbf7bde9abf8e54840ad61f81bebf5ea",province:"CAB",provinces:provinces,state:"GA",states:states,country:"US",countries:countries,supportEmail:"",supportEmails:supportEmails},methods:{initializeForm:function(){that=this,axios.get("https://api.ipstack.com/check?access_key="+that.api_key).then(function(e){if(ip=e.data.ip,"US"===e.data.country_code)for(var t=0;t<that.states.length;t++)that.states[t].id===e.data.region_code&&(that.state=e.data.region_code);else if("CA"===e.data.country_code)for(t=0;t<that.provinces.length;t++)that.provinces[t].id===e.data.region_code&&(that.province=e.data.region_code);processForm()}).catch(function(e){console.log("Geolocation error:",e),processForm()})}},mounted:function(){this.initializeForm()}});function processForm(){var u=window._DATA.contacts.divisions,g=window._DATA.contacts.territoryCodes,e=$("#country"),t=$("#state"),a=$("#province"),f=$("#supportEmail"),h=$("[name='formType']").val(),o="",v={},p=[],y=$(".submit.loader").hide();function r(){(v={}).country=countryData[o].territory[lang],"US"!=o&&"CA"!=o?(v.region=countryData[o].region,v.area=countryData[o].salesTerritory):"US"===o?(v.region=stateData[t.val()].region,v.area=stateData[t.val()].salesTerritory):"CA"===o&&(v.region=stateData[a.val()].region,v.area=stateData[a.val()].salesTerritory),0===p.length?$.get("https://thedotcom-data.s3.amazonaws.com/contacts.json").done(function(e){p=e,i()}).fail(function(e){console.log("error:",e)}):i()}function i(){for(var e=[],t=[],a=0;a<p.length;a++){var o=p[a].Title__c,r=null!=p[a].Division__c?u[p[a].Division__c.toLowerCase()]:"none",i=[];if(void 0===r){i=p[a].Division__c.toLowerCase().split(",");for(var s=0;s<i.length;s++)i[s]=u[i[s]]}else i="object"==typeof r?r:[r];var n=p[a].Sales_Territory__c||"";if(o&&(-1<o.toLowerCase().indexOf("rsvp")||-1<o.toLowerCase().indexOf("regional senior vice president")))for(s=0;s<i.length;s++)i[s]===v.region.toLowerCase()&&e.push(p[a]);else if(o&&(-1<o.toLowerCase().indexOf("rvp")||-1<o.toLowerCase().indexOf("regional vice president")))for(var c=0;c<v.area.length;c++)n.trim().toLowerCase()===v.area[c].trim().toLowerCase()&&t.push(p[a])}var l=e.concat(t),m=$("#contact__wrapper").html("");if(0<l.length){m.append('<div class="contacts"></div>');for(a=0;a<l.length;a++){var _=l[a],d='<div class="contact__contact"><div class="contact__nameHeader"><div class="contact__name">'+_.First_Name__c+" "+_.Last_Name__c+"</div>";n="";_.Title__c&&""!=_.Title__c&&null!=_.Title__c&&(_.Sales_Territory__c&&""!=_.Sales_Territory__c&&null!=_.Sales_Territory__c?n="<br/>"+(terrTranslations[_.Sales_Territory__c]?terrTranslations[_.Sales_Territory__c][lang]:_.Sales_Territory__c):"Regional Senior Vice President, Sales"===_.Title__c&&(n="<br/>"+(terrTranslations[_.Division__c]?terrTranslations[_.Division__c][lang]:_.Division__c)),d+='<div class="contact__title">'+("Regional Senior Vice President, Sales"===_.Title__c?globalLangData.rsvp:"Regional Vice President, Sales"===_.Title_c?globalLangData.rvp:_.Title__c)+n+"</div>"),d+="</div>",_.Mobile__c&&""!=_.Mobile__c&&null!=_.Mobile__c&&(d+='<div class="contact__mobile">'+globalLangData.mobile+': <a href="tel:'+_.Mobile__c+'">'+_.Mobile__c+"</a></div>"),_.Phone__c&&""!=_.Phone__c&&null!=_.Phone__c&&(d+='<div class="contact__phone">'+globalLangData.office+': <a href="tel:'+_.Phone__c+'">'+_.Phone__c+"</a></div>"),_.Email__c&&""!=_.Email__c&&null!=_.Email__c&&(d+='<div class="contact__email"><a href="mailto:'+_.Email__c.toLowerCase()+'">'+_.Email__c.toLowerCase()+"</a></div>"),m.find(".contacts").append(d)}}}$("#message").on("focus",function(){$("#message").val()===$("#message").data("default")&&$("#message").val("")}),e.on("change",function(){"US"===(o=e.val())?(t.addClass("contact__state--show").removeClass("contact__state--hidden"),a.addClass("contact__state--hidden").removeClass("contact__state--show")):"CA"===o?(t.addClass("contact__state--hidden").removeClass("contact__state--show"),a.addClass("contact__state--show").removeClass("contact__state--hidden")):(t.addClass("contact__state--hidden").removeClass("contact__state--show"),a.addClass("contact__state--hidden").removeClass("contact__state--show"),t.val("none"),a.val("none")),"Ownership"===h&&r()}).trigger("change"),"Ownership"===h&&(t.on("change",function(){r()}),a.on("change",function(){r()})),$("#contact__form").submit(function(e){e.preventDefault();var o="https://register.gulfstream.com/contactus?";$(".mkt").each(function(e,t){var a=$(t).val()?$(t).val():"";o+=$(t).attr("name")+"="+encodeURI(a.substring(0,100))+"&"}),o+="thankyou="+location.origin+$("#contact__form").attr("data-redirect"),$(".contact__error").html("");for(var t={},a=$(this).serializeArray(),r=0;r<a.length;r++)t[a[r].name]=a[r].value;var i="<h1>Gulfstream.com "+t.formType+" Contact Form Notifier</h1><h2>Form data:</h2><p>",s="Gulfstream.com "+t.formType+" Contact Form Notifier%0D%0A------------------------------------%0D%0AForm data:%0D%0A";if("Ownership"===h){t["Region Code"]=g[v.region];var n=new Date;t["Date Submitted"]=["January","February","March","April","May","June","July","August","September","October","November","December"][n.getMonth()]+" "+n.getDate()+", "+n.getFullYear()}for(var c in"US"!=t.Country?delete t.State:t.State=stateData[t.State].state[lang],"CA"!=t.Country?delete t.Province:t.Province=stateData[t.Province].state[lang],t.Country=countryData[t.Country].territory[lang],"Support"===h&&(t.Routing+=" ("+$("#supportEmail").find("option:selected").text()+")"),t)i+="formType"!=c?"<strong>"+c.replace(/_/g," ")+":</strong> "+t[c]+"<br/>":"",s+="formType"!=c?c.replace(/_/g," ")+": "+t[c]+"%0D%0A":"";i+="</p>";var l=t.Travel&&"special missions"===t.Travel.toLowerCase()?",special.missions@gulfstream.com":"";t.ip=ip;var m,_,d,u={emailTo:"Ownership"===t.formType?"sales.admins.all@gulfstream.com":f.val()?f.val():"cs.sales@gulfstream.com",noArchive:!1,emailBcc:"digital.marketing@gulfstream.com"+l,emailFrom:"notifier@gulfstream.aero",emailSubject:"Gulfstream.com "+t.formType+" contact form submitted",emailSource:"notifier@gulfstream.aero",emailReplyTo:"Ownership"===t.formType?"sales.admins.all@gulfstream.com, digital.marketing@gulfstream.com"+l:f.val()?f.val()+",digital.marketing@gulfstream.com":"cs.sales@gulfstream.com, digital.marketing@gulfstream.com",emailHTML:i,emailText:s,formId:"Gulfstream.com "+t.formType+" Contact Form",userId:t.Email,guid:(m=window.navigator,_=window.screen,d=m.mimeTypes.length,d+=m.userAgent.replace(/\D+/g,""),d+=m.plugins.length,d+=_.height||"",d+=_.width||"",d+=_.pixelDepth||""),userAgent:navigator.userAgent,formData:t},p=!0;$("input.required, select.required").each(function(e){""===$(this).val()||null===$(this).val()?($(this).addClass("required--unset"),p=!1):$(this).removeClass("required--unset")}),p?($("[name='submit']").attr("disabled","disabled").css("opacity",".5"),y.show(),"undefined"!=typeof hj&&hj("formSubmitSuccessful"),$.ajax({type:"POST",url:"https://api.gulfstream.aero/email/sendbyform",data:JSON.stringify(u),beforeSend:function(e){e.setRequestHeader("Content-Type","application/json")},success:function(e){e.success?window.location.replace(o):("undefined"!=typeof hj&&hj("formSubmitFailed"),y.hide(),$("[name='submit']").removeAttr("disabled").css("opacity","1"),$(".contact__error").html(e.data))}})):("undefined"!=typeof hj&&hj("formSubmitFailed"),$(".contact__error").html(globalLangData.all_required))})}